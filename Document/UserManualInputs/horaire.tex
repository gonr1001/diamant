\chapter{Construction d'un horaire avec \dx{}}

Construire un horaire avec \dx{} laisse supposer que l'utilisateur
a déjà sur son ordinateur les fichiers nécessaires (ceux du STI et
ceux de la Faculté)~: cours.sig, choixet.sig, disprof.sig et
locaux.txt. Ces fichiers peuvent porter n'importe quel nom, mais
pour notre exemple, les noms sont bien explicites. Il est
conseillé de regrouper toutes les informations concernant les
horaires d'un trimestre dans un répertoire (par exemple hiver04 ou
h2004). Ainsi, les fichiers d'importation et les fichiers produits
pendant la construction d'un horaire seront ensemble.

La construction d'un nouvel horaire avec \dx{} débute par une
phase de préparation commune à l'horaire de cycle et d'examen, et
se termine par la construction à proprement parler. Cette dernière
présente des caractéristiques particulières selon le type
d'horaire. Nous vous présenterons dans ce chapitre les phases de
préparation communes d'un horaire avec \dx{}, ainsi que les
caractéristiques particulières de la construction d'un horaire de
cycle et d'un horaire d'examen, toutefois, les options du logiciel
ne seront pas toutes présentées.

\section{Production d'un horaire de cycle}

\subsection{Préparation de l'horaire}

\begin{enumerate}
    \item Lancer \dx{}.
    \item Aller au menu \textbf{\emph{Fichier}},
    puis sélectionner le menu \textbf{\emph{Nouvel horaire}}
    et enfin sélectionner le sous-menu \textbf{\emph{Horaire cycle}}.
    Une boîte de dialogue comme celle
de la Figure \ref{selectgrillecyc} doit apparaître et elle vous
permettra de choisir le fichier (fichier avec extension \emph{xml})
contenant la configuration de votre grille horaire.

    \begin{figure}[h]
    % Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/selectXMLfile.eps}
        \caption{Selection de la grille horaire cycle}\label{selectgrillecyc}
    \end{center}
    \end{figure}

    \item En cliquant sur le bouton \emph{\textbf{OK}}, la grille horaire sélectionnée est chargée et présentée à l'écran (voir figure \ref{grillecyc}).
\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=4.5in]{UserManualInputs/images/grille.eps}
    \caption{Grille horaire cycle}\label{grillecyc}
  \end{center}
\end{figure}

    \item Aller au menu Fichier et sélectionner le menu \textbf{\emph{Définir fichiers à importer}}. Une boîte de dialogue comme celle de la Figure \ref{defautoimport}  doit apparaître. Repérer l'endroit où chacun des fichiers est localisé, puis cliquer sur le bouton \textbf{\emph{OK}}. Une nouvelle fenêtre se présentera afin de vous permettre d'enregistrer la configuration des fichiers (liste des fichiers à utiliser) que vous venez de faire.

Il est recommandé d'enregistrer cette configuration en utilisant un nom de fichier unique et représentatif.

Exemple: choisissez le nom de fichier \emph{E02cours} pour \emph{Été 2002 horaire de cours} et le fichier créé sera \emph{E02cours.dim}.

\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=2.5in]{UserManualInputs/images/autoimport.eps}
    \caption{Définition des fichiers d'importation}\label{defautoimport}
  \end{center}
\end{figure}

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Importer automatiquement}}.
    Une boite de dialogue apparaîtra et vous permettra de choisir le fichier de «configuration de fichiers»
    précédemment créé à partir de la fonction  \textbf{\emph{Définir fichiers à importer}}
    (dans l'exemple précédent il s'agit du fichier \emph{E02cours.dim}).
    Cliquer à présent sur le bouton \textbf{\emph{Importation de fichiers}},
    toutes vos données (cours, étudiants, enseignants et locaux) seront chargées dans le logiciel et
    prêtes à être modifiées.
\end{enumerate}

À partir de cette étape, la construction de l'horaire à proprement parler peut commencer. On pourra la découper en deux étapes, la première permettant de modifier et épurer les données et seconde permettant de faire une affectation initiale et d'optimiser les placements.

\subsection{Modification des données}

Modifier les données consiste à:
\begin{itemize}
    \item Modifier la disponibilité d'un enseignant en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Enseignants}} pour voir apparaître la fenêtre de la figure \ref{enseignant}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaitez modifier. Une zone sélectionnée apparaît en foncé et indique que l'enseignant y est disponible.
 
    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/enseignant.eps}
        \caption{Disponibilité des enseignants}\label{enseignant}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.    \\

    \item Modifier la disponibilité d'un local en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Locaux}} pour voir apparaître la fenêtre de la figure  \ref{local}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaité modifier. Une zone sélectionnée apparaît en foncé et indique que le local y est disponible. 

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/local.eps}
        \caption{Disponibilité des locaux}\label{local}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.\\

    \item Modifier les groupes d'étudiants en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Groupes}} pour voir apparaître la fenêtre de la figure \ref{groupe}. Sélectionner dans la colonne de droite (Étudiants assignés) le groupe (Groupe A, Groupe B, ...) que l'on souhaite modifier. Sélectionner ensuite un ou plusieurs étudiants que l'on souhaite déplacer. Utilisez enfin les flèches pour déplacer les étudiants de la gauche vers la droite ou vice-versa.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/groupe.eps}
        \caption{Affectation des groupes}\label{groupe}
      \end{center}
    \end{figure}

Cliquer sur le bouton \textbf{\emph{Par matricule/Par programme/Par nom}} dans le zone \emph{trier}, pour trier les étudiants par matricule, par programme ou par nom.

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.\\

    \item Modifier une activité en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Activités}} pour voir apparaître la \emph{liste des activités} (voir figure \ref{listact}) ou alors cliquer sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Événements}} pour voir apparaître la \emph{liste des événements (*** ou blocs?)} (voir figure \ref{listeevent}).\\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeact.eps}
        \caption{Liste des activités}\label{listact}
      \end{center}
    \end{figure}

À partir de la fenêtre \emph{liste des activités}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{inclue(s)} à \emph{non inclue(s)} (non inclue(s)= les activités ne seront pas utilisées dans la construction de l'horaire) et vice-versa. \\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeevent.eps}
        \caption{Liste des événements (*** ou blocs? )}\label{listeevent}
      \end{center}
    \end{figure}
   
À partir de la fenêtre \emph{liste des événements (*** ou blocs?)}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{figés} (les activités sont placées et figées dans la grille horaire) à \emph{placés} (les activités sont placées dans la grille horaire) ou de la colonne \emph{placés} à \emph{non placés} (les activités ne sont pas encore placées dans la grille horaire) et vice-versa. 

À partir de l'une ou l'autre des fenêtres, double-cliquer sur l'activité ou l'événement (*** ou blocs? ) à modifier pour faire apparaître la fenêtre d'\emph{affectation d'événements (*** ou blocs? )} (voir figure \ref{event}). Il vous possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements(*** ou blocs? )}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'activité.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/event.eps}
        \caption{Affectation d'événement (*** ou bloc? )}\label{event}
      \end{center}
    \end{figure}
    
Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Fermer}} pour fermer la fenêtre.\\
    
    \item Ajouter ou supprimer un groupe en cliquant sur le menu \textbf{\emph{Modification}} et le sous menu \textbf{\emph{Activité}} pour voir apparaître la fenêtre \textbf{\emph{Modification d'activités}} de la figure \ref{modifact}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifact.eps}
        \caption{Modification d'activités}\label{modifact}
      \end{center}
    \end{figure}

Double-cliquer sur l'activité que vous souhaitez modifier pour voir apparaître la fenêtre \textbf{\emph{Modification de types (*** ou nature)}} de la figure \ref{modiftype}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modiftype.eps}
        \caption{Modification de types (*** ou nature)}\label{modiftype}
      \end{center}
    \end{figure}

Double-cliquer sur le type (*** ou nature) que vous souhaitez modifier pour voir apparaître la fenêtre \textbf{\emph{Modification de sections (*** ou groupe)}} de la figure \ref{modifgroupe}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifgroupe.eps}
        \caption{Modification de sections (*** ou groupe)}\label{modifgroupe}
      \end{center}
    \end{figure}
À partir de cette fenêtre, vous avez trois possibilités:
        \begin{enumerate}
            \item Cliquer sur le bouton \textbf{\emph{Ajouter}}, pour ajouter un groupe. Le groupe sera ajouté à la suite du dernier groupe de la liste.
            \item Cliquer sur le bouton \textbf{\emph{Supprimer}}, pour supprimer un groupe. Le dernier groupe de la liste sera supprimé.
            \item Double-cliquer sur la section (*** ou groupe?) que vous souhaitez modifier pour voir apparaître la fenêtre \textbf{\emph{Modification d'unités (*** ou bloc?)}} de la figure \ref{modifunit}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifunit.eps}
        \caption{Modification d'unités (*** ou bloc)}\label{modifunit}
      \end{center}
    \end{figure}
            
            Double-cliquer sur l'unité (*** ou bloc?) que vous souhaitez modifier pour voir apparaître la fenêtre d'\emph{affectation d'événements(*** ou blocs? )} (voir figure \ref{event}). Il sera possible de faire, dans cette fenêtre, toutes les modifications décrites précédemment; il également possible de modifier la durée d'un événement (*** ou bloc?).
        \end{enumerate}    
 \end{itemize}    

\subsection{Optimisation des placements}

\section{Production d'un horaire d'examen}

\subsection{Préparation de l'horaire}

\begin{enumerate}
    \item Lancer \dx{}.
    \item Aller au menu \textbf{\emph{Fichier}},
    puis sélectionner le menu \textbf{\emph{Nouvel horaire}}
    et enfin sélectionner le sous-menu \textbf{\emph{Horaire examen}}.
    Une boîte de dialogue comme celle
de la Figure \ref{selectgrillecyc} doit apparaître et elle vous
permettra de choisir le fichier (fichier avec extension \emph{xml})
contenant la configuration de votre grille horaire.

    \begin{figure}[h]
    % Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/selectXMLfile.eps}
        \caption{Selection de la grille horaire cycle}\label{selectgrillecyc}
    \end{center}
    \end{figure}

    \item En cliquant sur le bouton \emph{\textbf{OK}}, la grille horaire sélectionnée est chargée et présentée à l'écran (voir figure \ref{grillecyc}).
\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=4.5in]{UserManualInputs/images/grille.eps}
    \caption{Grille horaire cycle}\label{grillecyc}
  \end{center}
\end{figure}

    \item Aller au menu Fichier et sélectionner le menu \textbf{\emph{Définir fichiers à importer}}. Une boîte de dialogue comme celle de la Figure \ref{defautoimport}  doit apparaître. Repérer l'endroit où chacun des fichiers est localisé, puis cliquer sur le bouton \textbf{\emph{OK}}. Une nouvelle fenêtre se présentera afin de vous permettre d'enregistrer la configuration des fichiers (liste des fichiers à utiliser) que vous venez de faire.

Il est recommandé d'enregistrer cette configuration en utilisant un nom de fichier unique et représentatif.

Exemple: choisissez le nom de fichier \emph{E02cours} pour \emph{Été 2002 horaire de cours} et le fichier créé sera \emph{E02cours.dim}.

\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=2.5in]{UserManualInputs/images/autoimport.eps}
    \caption{Définition des fichiers d'importation}\label{defautoimport}
  \end{center}
\end{figure}

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Importer automatiquement}}.
    Une boite de dialogue apparaîtra et vous permettra de choisir le fichier de «configuration de fichiers»
    précédemment créé à partir de la fonction  \textbf{\emph{Définir fichiers à importer}}
    (dans l'exemple précédent il s'agit du fichier \emph{E02cours.dim}).
    Cliquer à présent sur le bouton \textbf{\emph{Importation de fichiers}},
    toutes vos données (cours, étudiants, enseignants et locaux) seront chargées dans le logiciel et
    prêtes à être modifiées.
\end{enumerate}

À partir de cette étape, la construction de l'horaire à proprement parler peut commencer. On pourra la découper en deux étapes, la première permettant de modifier et épurer les données et seconde permettant de faire une affectation initiale et d'optimiser les placements.

\subsection{Modification des données}

Modifier les données consiste à:
\begin{itemize}
    \item Modifier la disponibilité d'un enseignant en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Enseignants}} pour voir apparaître la fenêtre de la figure \ref{enseignant}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaitez modifier. Une zone sélectionnée apparaît en foncé et indique que l'enseignant y est disponible.
 
    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/enseignant.eps}
        \caption{Disponibilité des enseignants}\label{enseignant}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.    \\

    \item Modifier la disponibilité d'un local en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Locaux}} pour voir apparaître la fenêtre de la figure  \ref{local}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaité modifier. Une zone sélectionnée apparaît en foncé et indique que le local y est disponible. 

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/local.eps}
        \caption{Disponibilité des locaux}\label{local}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.\\

    \item Modifier une activité en cliquant sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Activités}} pour voir apparaître la \emph{liste des activités} (voir figure \ref{listact}) ou alors cliquer sur le menu \textbf{\emph{Affection}} et le sous menu \textbf{\emph{Événements}} pour voir apparaître la \emph{liste des événements (*** ou blocs?)} (voir figure \ref{listeevent}).\\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeact.eps}
        \caption{Liste des activités}\label{listact}
      \end{center}
    \end{figure}

À partir de la fenêtre \emph{liste des activités}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{inclue(s)} à \emph{non inclue(s)} (non inclue(s)= les activités ne seront pas utilisées dans la construction de l'horaire) et vice-versa. \\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeevent.eps}
        \caption{Liste des événements (*** ou blocs? )}\label{listeevent}
      \end{center}
    \end{figure}
   
À partir de la fenêtre \emph{liste des événements (*** ou blocs?)}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{figés} (les activités sont placées et figées dans la grille horaire) à \emph{placés} (les activités sont placées dans la grille horaire) ou de la colonne \emph{placés} à \emph{non placés} (les activités ne sont pas encore placées dans la grille horaire) et vice-versa. 

À partir de l'une ou l'autre des fenêtres, double-cliquer sur l'activité ou l'événement (*** ou blocs? ) à modifier pour faire apparaître la fenêtre d'\emph{affectation d'événements (*** ou blocs? )} (voir figure \ref{event}). Il vous possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements(*** ou blocs? )}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'activité.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/event.eps}
        \caption{Affectation d'événement (*** ou bloc? )}\label{event}
      \end{center}
    \end{figure}
    
Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Fermer}} pour fermer la fenêtre.
 \end{itemize}    

\subsection{Optimisation des placements} 