\chapter{Construction d'un horaire avec \dx{}}

Construire un horaire avec \dx{} laisse supposer que l'utilisateur
a déjà sur son ordinateur les fichiers nécessaires (ceux du STI et
ceux de la Faculté)~: cours.sig, choixet.sig, disprof.sig et
locaux.txt. Ces fichiers peuvent porter n'importe quel nom, mais
pour notre exemple, les noms sont bien explicites. Il est
conseillé de regrouper toutes les informations concernant les
horaires d'un trimestre dans un répertoire (par exemple hiver04 ou
h2004). Ainsi, les fichiers d'importation et les fichiers produits
pendant la construction d'un horaire seront ensemble.

La construction d'un nouvel horaire avec \dx{} comporte cinq phases: 
\begin{itemize}
    \item Phase 1: elle concerne la préparation de données;
    \item Phase 2: elle concerne la modification et d'épuration des données;
    \item Phase 3: elle concerne la construction à proprement parler;
    \item Phase 4: elle concerne l'utilisation d'outils permettant de raffiner l'horaire (Affectation manuelle, rapports, etc);
    \item Phase 5: elle concerne l'exportation de l'horaire.
\end{itemize}    

Nous vous présenterons dans ce chapitre toutes ces phases appliquées à la construction d'un horaire de cours et d'un horaire d'examen. Toutefois, les options du logiciel ne seront pas toutes présentées.

\section{Production d'un horaire de cours}\label{prepacours}

\subsection{Phase 1: préparation de l'horaire}\label{finprepa}

\begin{enumerate}
    \item Lancer \dx{}.
    \item Aller au menu \textbf{\emph{Fichier}} \Rar \textbf{\emph{Nouvel horaire}}
    et enfin sélectionner le sous-menu \textbf{\emph{Horaire cycle}}.
    Une boîte de dialogue comme celle
de la Figure \ref{selectgrillecyc} doit apparaître et elle vous
permettra de choisir le fichier (fichier avec extension \emph{.xml})
contenant la définition de votre grille horaire.

    \begin{figure}[h]
    % Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/selectXMLfile.eps}
        \caption{Selection de la grille horaire de cours}\label{selectgrillecyc}
    \end{center}
    \end{figure}

    \item En cliquant sur le bouton \emph{\textbf{OK}}, la grille horaire sélectionnée est chargée et présentée à l'écran (voir figure \ref{grillecyc}).
\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=4.5in]{UserManualInputs/images/grille.eps}
    \caption{Grille horaire de cours}\label{grillecyc}
  \end{center}
\end{figure}

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Définir fichiers à importer}}. Une boîte de dialogue comme celle de la Figure \ref{defautoimport}  doit apparaître. Repérer l'endroit où chacun des fichiers est localisé, puis cliquer sur le bouton \textbf{\emph{OK}}. Une nouvelle fenêtre se présentera afin de vous permettre d'enregistrer la configuration des fichiers que vous venez de faire.

Il est recommandé d'enregistrer cette configuration en utilisant un nom de fichier unique et représentatif.

Exemple: choisissez le nom de fichier \emph{E02cours} pour \emph{Été 2002 horaire de cours} et le fichier créé sera \emph{E02cours.dim}. L'extension \textbf{\emph{.dim}} est rajouté automatiquement.

\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=2.5in]{UserManualInputs/images/autoimport.eps}
    \caption{Définition des fichiers d'importation}\label{defautoimport}
  \end{center}
\end{figure}

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Importer automatiquement}}.
    Une boite de dialogue apparaîtra et vous permettra de choisir le fichier \textbf{\emph{.dim}} de «configuration de fichiers»
    précédemment créé à partir de la fonction  \textbf{\emph{Définir fichiers à importer}}
    (dans l'exemple précédent il s'agit du fichier \emph{E02cours.dim}).
    Cliquer à présent sur le bouton \textbf{\emph{Importation de fichiers}},
    toutes vos données (cours, étudiants, enseignants et locaux) seront chargées dans le logiciel et
    prêtes à être modifiées.
\end{enumerate}

À partir de cette étape, la construction de l'horaire à proprement parler peut commencer. Il est vivement recommandé de lancer l'\textbf{\emph{affectation initiale}} à partir du menu \textbf{\emph{Optimisation}} avant de poursuivre la production de l'horaire. Lancer l'\textbf{\emph{affectation initiale}} à cette étape exécuterait les fonctionnalités suivantes:

\begin{enumerate}
    \item Placer de façon aléatoire dans les groupes d'activité, les étudiants non pré-affectés à des groupes, tout en équilibrant les groupes.
    \item Placer les événements pré-affectés (placés ou figés) dans la grille horaire.
    \item Calculer les conflits générés.
\end{enumerate}

Cette affectation initiale permettrait donc d'initialiser le logiciel de sorte à pouvoir faire des modifications sur les données et observer immédiatement les repercussions sur l'horaire.

La préparation de l'horaire étant achevée, nous pouvons à présent passer à la phase de modification et d'épuration de données (phase 2). Il est cependant nécessaire de noter que cette phase peut avoir lieu avant ou après la phase de construction à proprement parler (phase 3), mais nous recommandons de la faire avant la phase 3 afin de travailler une bonne fois pour toute sur des données propres (épurées).

\subsection{Phase 2: modification et épurations des données}

Le but de cette étape est de permettre de construire l'horaire uniquement à partir de données propres. Cette modification et/ou épuration peut se faire sur les activités, les événements, les groupes d'étudiants, les enseignants ou les locaux.

\begin{itemize}
    \item Modifier une activité en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Activités}} pour voir apparaître la \emph{liste des activités} (voir figure \ref{listactc}) ou alors cliquer sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Événements}} pour voir apparaître la \emph{liste des événements} (voir figure \ref{listeeventc}).\\

À partir de la fenêtre \emph{liste des événements}, vous pouvez sélectionner un ou plusieurs événements et les faire passer de la colonne \emph{figés} (les événements sont placées et figées dans la grille horaire) à \emph{placés} (les événements sont placées dans la grille horaire) ou de la colonne \emph{placés} à \emph{non placés} (les événements ne sont pas encore placées dans la grille horaire) et vice-versa.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeact.eps}
        \caption{Liste des activités}\label{listactc}
      \end{center}
    \end{figure}

À partir de la fenêtre \emph{liste des activités}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{inclue(s)} à \emph{non inclue(s)} (non inclue(s)= les activités ne seront pas utilisées dans la construction de l'horaire) et vice-versa. \\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeevent.eps}
        \caption{Liste des événements}\label{listeeventc}
      \end{center}
    \end{figure}


À partir de l'une ou l'autre des fenêtres, double-cliquer sur l'activité ou l'événement à modifier pour faire apparaître le dialogue d'\emph{affectation d'événements} (voir figure \ref{eventc}). Il vous est possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'activité.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/event.eps}
        \caption{Affectation d'événement}\label{eventc}
      \end{center}
    \end{figure}
    
Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Fermer}} pour fermer la fenêtre sans appliquer les changements.\\

    \item Ajouter ou supprimer un groupe ou un événement en cliquant sur le menu \textbf{\emph{Modification}} et le sous menu \textbf{\emph{Activité}} pour voir apparaître la fenêtre d'\textbf{\emph{Activités}} de la figure \ref{modifactc}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifact.eps}
        \caption{Modification d'activités}\label{modifactc}
      \end{center}
    \end{figure}

Double-cliquer sur l'activité que vous souhaitez modifier pour voir apparaître la fenêtre de \textbf{\emph{Natures}} de la figure \ref{modiftypec}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modiftype.eps}
        \caption{Modification de natures}\label{modiftypec}
      \end{center}
    \end{figure}

Double-cliquer sur la nature que vous souhaitez modifier pour voir apparaître la fenêtre de \textbf{\emph{Groupes)}} de la figure \ref{modifgroupec}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifgroupe.eps}
        \caption{Modification de groupe}\label{modifgroupec}
      \end{center}
    \end{figure}
À partir de cette fenêtre, vous avez trois possibilités:
        \begin{enumerate}
            \item Cliquer sur le bouton \textbf{\emph{Ajouter}}, pour ajouter un groupe. Le groupe sera ajouté à la suite du dernier groupe de la liste.
            \item Cliquer sur le bouton \textbf{\emph{Supprimer}}, pour supprimer un groupe. Le dernier groupe de la liste sera supprimé.
            \item Double-cliquer sur le groupe que vous souhaitez modifier pour voir apparaître la fenêtre d'\textbf{\emph{Événements}} de la figure \ref{modifunitc}. À partir de cette fenêtre, pour pouvez ajouter, supprimer ou modifier un événement.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/modifunit.eps}
        \caption{Modification d'événements}\label{modifunitc}
      \end{center}
    \end{figure}

            Double-cliquer sur l'événement que vous souhaitez modifier pour voir apparaître la fenêtre d'\emph{affectation d'événements} (voir figure \ref{eventc}). Il sera possible de faire, dans cette fenêtre, toutes les modifications décrites précédemment; il également possible de modifier la durée d'un événement.
        \end{enumerate}

\item Modifier les groupes d'étudiants en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Groupes}} pour voir apparaître la fenêtre de la figure \ref{groupec}. Sélectionner dans la colonne de droite (Étudiants assignés) le groupe (Groupe A, Groupe B, ...) que l'on souhaite modifier. Sélectionner ensuite un ou plusieurs étudiants que l'on souhaite déplacer. Utilisez enfin les flèches pour déplacer les étudiants de la gauche vers la droite ou vice-versa.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/groupe.eps}
        \caption{Affectation des groupes}\label{groupec}
      \end{center}
    \end{figure}

Cliquer sur le bouton \textbf{\emph{Par matricule/Par programme/Par nom}} dans le zone \emph{trier}, pour trier les étudiants par matricule, par programme ou par nom.

Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Ok}} pour valider les changements et fermer la fenêtre.\\

\item Modifier la disponibilité d'un enseignant en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Enseignants}} pour voir apparaître la fenêtre de la figure \ref{enseignantc}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaitez modifier. Une zone sélectionnée apparaît en foncé et indique que l'enseignant y est disponible.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/enseignant.eps}
        \caption{Disponibilité des enseignants}\label{enseignantc}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour accepter et effectuer les changements et Cliquer sur \textbf{\emph{Ok}} pour accepter, effectuer les changements et fermer la fenêtre.    \\

    \item Modifier la disponibilité d'un local en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Locaux}} pour voir apparaître la fenêtre de la figure  \ref{localc}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaité modifier. Une zone sélectionnée apparaît en foncé et indique que le local y est disponible.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/local.eps}
        \caption{Disponibilité des locaux}\label{localc}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour accepter et effectuer les changements et Cliquer sur \textbf{\emph{Ok}} pour accepter, effectuer les changements et fermer la fenêtre.\\

 \end{itemize}

\subsection{Phase 3: construction de l'horaire}

Il est vivement recommandé de commencer cette étape en lançant l'\textbf{\emph{affectation initiale}} à partir du menu \textbf{\emph{Optimisation}} (si cela n'a pas été précédemment fait à la fin de la phase de préparation de l'horaire - section \ref{finprepa}) avant de poursuivre la production de l'horaire. La description des commandes exécutées par l'affectation initiale est faite à la section \ref{finprepa}.

Une fois l'affectation initiale effectuée, l'étape suivante consiste à lancer le sous menu \textbf{\emph{Construire l'horaire}} à partir du menu \textbf{\emph{Optimisation}}, afin de laisser le logiciel placer automatiquement dans la grille horaire les événements (ceux qui n'ont pas encore été placés dans la grille horaire) respectant toutes les contraintes spécifiées et ne créant aucun nouveau conflit (conflits d'enseignants, conflits d'étudiants et conflits de locaux).

La modification des contraintes à respecter par \dx{} lors de la construction automatique de l'horaire se fait en lançant le sous-menu \textbf{\emph{Options Conflits}} à partir du menu \textbf{\emph{Préférences}} pour faire apparaître la fenêtre d'option de conflits (voir figure \ref{confc}). Cette fenêtre permet de modifier plusieurs paramètres, à savoir:

\begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=3.5in]{UserManualInputs/images/optionconflict.eps}
        \caption{Contraintes à respecter}\label{confc}
      \end{center}
    \end{figure}

\begin{itemize}
    \item \emph{Max Conflits Étu entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits d'étudiants entre deux événements, dans une période.
    \item \emph{Max Conflits Ens entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits d'enseignants entre deux événements, dans une période.
    \item \emph{Max Conflits Loc entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits de locaux entre deux événements, dans une période.
    \item \emph{Placer dans périodes (0=normale, 1=normale et basse, 2=normale, basse et nulle)}: ce paramètre permet de spécifier les types de périodes (normale, basse, nulle) de la grille horaire dans lesquels un événement peut être placé.
    \item \emph{Nombre Max de cours dans une période}: ce paramètre permet de spécifier le nombre maximal d'événements pouvant être placés dans une même période de la grille horaire.
    \item \emph{Période d'écart}: ce paramètre permet de spécifier l'écart (en nombre de périodes) à respecter entre deux événements potentiellement en conflit (conflits d'étudiants).
\end{itemize}

Il est possible de modifier les contraintes et lancer ensuite la construction de l'horaire afin que le logiciel  utilise les nouvelles contraintes pour placer les événements qu'il n'a pas pu précédemment placer; tout ceci de façon itérative jusqu'à obtention d'un résultat paraissant satisfaisant aux yeux de l'utilisateur.

Il est également possible de revenir à l'état initial de l'horaire (l'état de l'horaire juste après l'affectation initiale). Pour cela, il suffit de d'ouvrir la fenêtre \textbf{\emph{Liste des événements}} à partir du sous-menu \textbf{\emph{Événements}} du menu \textbf{\emph{Affectation}}, ensuite de sélectionner tous les événements de la colonnes des \textbf{\emph{Placés}}, puis de les faire passer de la colonne des \textbf{\emph{Placés}} à celle des \textbf{\emph{Non placés}} en cliquant sur la flèche allant de la gauche vers la droite et enfin cliquer sur le bouton Appliquer pour effectuer les changements.

Si malgré les itérations, l'horaire construit n'est pas satisfaisant, il existe un certain nombre d'outils permettant de raffiner manuellement l'horaire.


\subsection{Phase 4: raffinement de l'horaire}
Le raffinement de l'horaire propose à travers certains outils (affectation manuelle, formation de groupes, modification, rapports), les voies et moyens d'amélioration de l'horaire construit.

\subsubsection{Affectation manuelle}

L'affectation manuelle permet à l'utilisateur de placer individuellement les événements dans la grille horaire. Elle se fait à partir de la fenêtre d'\textbf{\emph{Affection manuelle}} (voir figure \ref{manc}) obtenue à partir du sous-menu \textbf{\emph{Affectation manuelle}} du menu \textbf{\emph{Affectation}}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=3.5in]{UserManualInputs/images/manualaffect.eps}
        \caption{Affectation manuelle}\label{manc}
      \end{center}
    \end{figure}

La fenêtre d'affectation manuelle offre deux possibilités d'utilisation:

\begin{enumerate}
    \item \textbf{Modification d'un événement:} sélectionner un événement et cliquer sur le bouton \textbf{\emph{Modifier}} pour faire apparaître le dialogue d'\emph{affectation d'événements} (voir figure \ref{evente}). Il vous est possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'événement.
    \item \textbf{Recherche de potentiels conflits:} pour rechercher les potentiels conflits générés par un événement, double-cliquer sur l'événement en question pour voir apparaître une nouvelle grille horaire (voir figure \ref{man1c}) vous informant sur les conflits que peut généré l'événement dans chaque période de la grille horaire. \\

Une représentation par les couleurs, de la grille horaire d'affectation manuelle, a été adoptée afin de vous permettre, d'un seul coup d'oeil, de repérer les périodes de potentiels conflits (couleur rouge), les périodes dans lesquelles l'événement peut être placé sans générer de conflits (couleur par défaut de la période), et la ou les périodes dans lesquelles l'événement est placé (s'il était précédemment placé dans le grille - couleur verte). Les périodes possédant déjà des conflits avant le lancement de l'amélioration manuelle sont aussi représentées par la couleur rouge; il faut dans ce cas, après le lancement de l'affectation manuelle, regarder pour chaque événement de la période les potentiels conflits avec le nouvel événement.

\subsubsection{Exemple: interprétation d'une période de couleur rouge}

Les données ci-dessous représentent une période la grille horaire d'affectation manuelle de l'événement GEI220.1.01.1.
\begin{verbatim}
ADM111.1.02.1 0 1 0
GEI100.1.01.1 5 0 0
GEI200.1.01.1 5 0 1
     13 2 1
\end{verbatim}

Elles sont interprétées de la manière suivante:
\begin{itemize}
    \item La ligne \verb!ADM111.1.02.1! \textcolor[rgb]{1.00,0.00,0.00}{0 1 0} représente les potentiels conflits entre les événements \verb!ADM111.1.02.1! et \verb!GEI220.1.01.1!. Elle indique 0 conflit d'étudiants, 1 conflit d'enseignants et 0 conflit de locaux.
    \item La ligne \verb!GEI100.1.01.1! \textcolor[rgb]{1.00,0.00,0.00}{5 0 0} représente les potentiels conflits entre les événements \verb!GEI100.1.01.1! et \verb!GEI220.1.01.1!. Elle indique 5 conflits d'étudiants, 0 conflit d'enseignants et 0 conflit de locaux.
    \item La ligne \verb!GEI200.1.01.1! \textcolor[rgb]{1.00,0.00,0.00}{5 0 1} représente les potentiels conflits entre les événements \verb!GEI200.1.01.1! et \verb!GEI220.1.01.1!. Elle indique 5 conflits d'étudiants, 0 conflit d'enseignants et 1 conflit de locaux.
    \item La ligne \textcolor[rgb]{1.00,0.00,0.00}{13 2 1} représente la somme des potentiels conflits de la période (10 conflicts d'étudiants, 1 conflit d'enseignants, 1 conflit de locaux) aux conflits réels existant dans la période (3 conflits d'étudiants, 1 conflit d'enseignants et 0 conflit de locaux).
\end{itemize}    

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/manualaffectres.eps}
        \caption{Grille horaire d'affectation manuelle}\label{man1c}
      \end{center}
    \end{figure}

\end{enumerate}

\subsubsection{Modification des activités}

La fonctionnalité de modification des activités permet d'ajouter ou supprimer une nature à une activité, d'ajouter ou supprimer un groupe à une nature d'activité, d'ajouter ou supprimer un bloc à un groupe et enfin modifier la durée d'un événement ou affecter un événement comme présenté dans la figure \ref{eventc}. Il faut cependant noter qu'elle ne permet pas d'ajouter une activité.

La modification d'une activité se fait en cascade, c'est à dire que pour faire des modifications sur un niveau, il faudrait traverser les niveaux précédents (par exemple, pour faire des modifications sur un groupe, il faut d'abord sélectionner l'activité concernée, ensuite sélectionner la nature et enfin sélectionner le groupe concerné).

\subsubsection{Ajout/suppression d'une nature à une activité}

Ajouter et/ou supprimer une nature à une activité se fait en lançant le sous menu \textbf{\emph{Activité}} à partir du menu \textbf{\emph{Modification}}, pour faire apparaître la fenêtre d'activités de la figure \ref{modifactc}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifact.eps}
        \caption{Modification d'activités}\label{modifactc}
      \end{center}
    \end{figure}

Double cliquer sur une activité pour faire apparaître la fenêtre de natures de la figure \ref{modiftypec}. Toutes les natures de l'activité sélectionnée apparaissent dans cette fenêtre.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modiftype.eps}
        \caption{Modification de natures}\label{modiftypec}
      \end{center}
    \end{figure}

\begin{itemize}
    \item On ne peut ajouter qu'une nature 2 à une activité possédant préalablement une nature 1. Pour le faire cliquer simplement sur le bouton \textbf{\emph{Ajouter}}.
    \item On ne peut supprimer qu'une nature 2 à une activité. Pour le faire cliquer simplement sur le bouton \textbf{\emph{Supprimer}}.
\end{itemize}

\subsubsection{Ajout/suppression d'un groupe à une nature d'activité}

À partir de la fenêtre de modification de natures (voir figure \ref{modiftypec}), double cliquer sur une nature d'activité pour faire apparaître la fenêtre de groupes de la figure \ref{modifgroupec}. Tous les groupes de la nature sélectionnée apparaissent dans cette fenêtre.

 \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifgroupe.eps}
        \caption{Modification de groupes}\label{modifgroupec}
      \end{center}
    \end{figure}

\begin{itemize}
    \item Pour ajouter un groupe cliquer sur le bouton \textbf{\emph{Ajouter}} pour voir apparaître la fenêtre de la figure \ref{modifgroupeselecc}
\begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifgroupeselect.eps}
        \caption{Choix du groupe à ajouter}\label{modifgroupeselecc}
      \end{center}
    \end{figure}
    Entrer le nom du groupe à ajouter et cliquer sur \textbf{\emph{Ok}} (Exemple: pour créer un groupe 3, entrer dans la zone \emph{Numéro de groupe} la valeur 03).
    \item Pour supprimer un groupe, sélectionner le groupe à supprimer et cliquer simplement sur le bouton \textbf{\emph{Supprimer}}.
\end{itemize}

\subsubsection{Ajout/suppression d'un bloc à un groupe d'une nature d'activité}

À partir de la fenêtre de modification de groupe (voir figure \ref{modifgroupec}), double cliquer sur un groupe pour faire apparaître la fenêtre de blocs de la figure \ref{modifblocc}. Tous les blocs du groupe sélectionné apparaissent dans cette fenêtre.

    \begin{figure}[h]
        % Requires \usepackage{graphicx}
        \begin{center}
            \includegraphics[width=2.0in]{UserManualInputs/images/modifunit.eps}
            \caption{Choix du groupe à ajouter}\label{modifblocc}
        \end{center}
    \end{figure}

\begin{itemize}
    \item On ne peut ajouter un bloc à un groupe en cliquant simplement sur le bouton \textbf{\emph{Ajouter}}. Le nouveau bloc est créé à la suite du dernier bloc de la liste.
    \item Pour supprimer un bloc, cliquer simplement sur le bouton \textbf{\emph{Supprimer}} et le dernier bloc de la liste sera supprimé. Si la liste ne possède qu'un seul bloc, ce dernier ne pourra pas être supprimé.
\end{itemize}

\subsubsection{Formation de groupes}

La formation de groupe communément appelé «brassage d'étudiants dans les groupes» peut se faire de trois façons distinctes:

\begin{itemize}
    \item En cliquant sur \textbf{\emph{Balancé}} dans le sous menu \textbf{\emph{Formation de groupes}} du menu \textbf{\emph{optimisation}}, le logiciel brasse les étudiants des activités déjà placées dans la grille horaire, de sorte à les placer dans les groupes en minimisant les conflits et en ne tolérant qu'un écart d'un étudiant entre les différents groupes d'une même activité.
    \item En cliquant sur \textbf{\emph{Intermédiaire}} dans le sous menu \textbf{\emph{Formation de groupes}} du menu \textbf{\emph{optimisation}}, le logiciel brasse les étudiants des activités déjà placées dans la grille horaire, de sorte à les placer dans les groupes en minimisant une fois de plus les conflits, mais en tolérant cette fois ci un écart de 15 (\textcolor[rgb]{1.00,0.00,0.00}{valeur à paramétrer si besoin se fait sentir}) étudiants au plus entre les différents groupes d'une même activité.
    \item En cliquant sur \textbf{\emph{Optimisé}} dans le sous menu \textbf{\emph{Formation de groupes}} du menu \textbf{\emph{optimisation}}, le logiciel brasse les étudiants des activités déjà placées dans la grille horaire, de sorte à les placer dans les groupes en minimisant les conflits et en autorisant tous les écarts entre les différents groupes d'une même activité.
\end{itemize}

\subsubsection{Rapports}

La fonctionnalité rapport permet de visualiser le rapport complet des événements placés dans la grille horaire, de visualiser le rapport de conflits générés par les événements placés dans la grille horaire et de visualiser les erreurs survenues lors de l'importation de données.

\subsubsection{Rapport complet}

Le rapport complet permet de visualiser les événements placés dans la grille horaire (voir figure \ref{rapfullc}).

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/rap_full.eps}
        \caption{Rapport complet}\label{rapfullc}
    \end{center}
\end{figure}

Les informations affichées sont trier en partant de la colonne de gauche vers la droite. Les abbreviations utilisées au niveau de l'entête du rapport se définissent comme suit:

\begin{itemize}
    \item \emph{JNum}: numéro de de la journée (jour 1, jour 2, ...),
    \item \emph{Jour}: nom de la journée (lundi, mardi, ...),
    \item \emph{Acti}: nom de l'activité,
    \item \emph{Nat}: nature de l'activité,
    \item \emph{Grp}: groupe de l'activité,
    \item \emph{Blc}: bloc de l'activité,
    \item \emph{Nomb É}: nombre d'étudiants,
    \item \emph{Durée}: durée de l'événement,
    \item \emph{Début}: heure de début de l'événement,
    \item \emph{Fin}: heure de fin de l'événement,
    \item \emph{Enseignant}: nom de l'enseignant,
    \item \emph{Local}: nom du local.
\end{itemize}

Les informations à afficher pour chaque événement peuvent être définies à partir de la fenêtre d'\textbf{\emph{Option de rapport}}, en cliquant sur le bouton \textbf{\emph{Options}} à partir de la fenêtre de \textbf{\emph{Rapport complet}} (voir figure \ref{rapfullc}).

\subsubsection{Option de rapport complet}

Cette fenêtre d'\textbf{\emph{Option de rapport}} (voir figure \ref{rapfulloptionsc}) permet de choisir les information à afficher dans le rapport complet. L'ordre d'apparition des champs dans la colonne \emph{Champs choisis} (du haut vers le bas), définit l'ordre dans lequel ces champs apparaîtront dans le rapport complet (de la gauche vers la droite).

Utiliser les boutons avec les flèches pour déplacer un champ d'une colonne vers une autre et les boutons avec les signes $+$ ou $-$ pour déplacer un champ du haut vers le bas et vice-versa.

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/rap_full_options.eps}
        \caption{Options du rapport complet}\label{rapfulloptionsc}
    \end{center}
\end{figure}


\subsubsection{Rapport de conflits}

Le rapport de conflits permet de visualiser les conflits générés par les événements placés dans la grille horaire (voir figure \ref{rapconfc}).

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/rap_conflicts.eps}
        \caption{Rapport de conflits}\label{rapconfc}
    \end{center}
\end{figure}

Les informations affichées sont trier en partant de la colonne de gauche vers la droite. Les abbreviations utilisées au niveau de l'entête du rapport se définissent comme suit:

\begin{itemize}
    \item \emph{JNum}: numéro de de la journée (jour 1, jour 2, ...),
    \item \emph{Jour}: nom de la journée (lundi, mardi, ...),
    \item \emph{PérJour}: période de la journée (AM, PM),
    \item \emph{Événement 1 }: premier événement en conflit,
    \item \emph{Événement 2}: événement avec lequel l'événement 1 est en conflit ou description du conflit si l'événement 1 présente un conflit interne (disponibilité de l'enseignant, disponibilité du local et/ou capacité du local inférieur au nombre d'étudiants).
    \item \emph{Début}: heure de début de l'événement,
    \item \emph{Type Conf}: type de conflits (étudiant, enseignant ou local),
    \item \emph{Numb C}: nombre de conflits,
    \item \emph{Conflits}: détail du conflit (liste des étudiants en conflit, nom du local ou de l'enseignant en conflit).
\end{itemize}

Les informations à afficher pour chaque conflit peuvent être définies à partir de la fenêtre d'\textbf{\emph{Option de conflits}}, en cliquant sur le bouton \textbf{\emph{Options}} à partir de la fenêtre de \textbf{\emph{Rapport de conflits}} (voir figure \ref{rapconfc}).

\subsubsection{Option de rapport de conflits}

Cette fenêtre d'\textbf{\emph{Option de conflits}} (voir figure \ref{rapconfoptionsc}) permet de choisir les information à afficher dans le rapport de conflits. L'ordre d'apparition des champs dans la colonne \emph{Champs choisis} (du haut vers le bas), définit l'ordre dans lequel ces champs apparaîtront dans le rapport complet (de la gauche vers la droite).

Utiliser les boutons avec les flèches pour déplacer un champ d'une colonne vers une autre et les boutons avec les signes $+$ ou $-$ pour déplacer un champ du haut vers le bas et vice-versa.

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/rap_conflicts_options.eps}
        \caption{Options du rapport de conflits}\label{rapconfoptionsc}
    \end{center}
\end{figure}

\subsection{Phase 5: Exportation}

Pour exporter les données, aller au menu \textbf{\emph{Fichier}}, puis sélectionner \textbf{\emph{Exporter}}; deux fichiers seront créés dans le repertoire racine de votre document avec les noms suivants:
\begin{itemize}
    \item \verb!«nom du document»_Export_1.txt! (il contient l'horaire);
    \item \verb!«nom du document»_Export_2.txt! (il contient les étudiants, leurs choix d'activité et leurs groupes).
\end{itemize}     

\section{Production d'un horaire d'examen}\label{prepaexam}

\subsection{Phase 1: préparation de l'horaire}\label{finprepae}

\begin{enumerate}
    \item Lancer \dx{}.
    \item Aller au menu \textbf{\emph{Fichier}},
    puis sélectionner le menu \textbf{\emph{Nouvel horaire}}
    et enfin sélectionner le sous-menu \textbf{\emph{Horaire Examen}}.
    Une boîte de dialogue comme celle
de la Figure \ref{selectgrilleexam} doit apparaître et elle vous
permettra de choisir le fichier (fichier avec extension \emph{.xml})
contenant la définition de votre grille horaire.

    \begin{figure}[h]
    % Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/selectXMLfileExam.eps}
        \caption{Selection de la grille horaire d'examen}\label{selectgrilleexam}
    \end{center}
    \end{figure}

    \item En cliquant sur le bouton \emph{\textbf{OK}}, la grille horaire sélectionnée est chargée et présentée à l'écran (voir figure \ref{grilleexam}).
\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=4.5in]{UserManualInputs/images/grilleexam.eps}
    \caption{Grille horaire d'examen}\label{grilleexam}
  \end{center}
\end{figure}

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Définir fichiers à importer}}. Une boîte de dialogue comme celle de la Figure \ref{defautoimportex}  doit apparaître. Repérer l'endroit où chacun des fichiers est localisé, puis cliquer sur le bouton \textbf{\emph{OK}}. Une nouvelle fenêtre se présentera afin de vous permettre d'enregistrer la configuration des fichiers que vous venez de faire.

\begin{figure}[h]
  % Requires \usepackage{graphicx}
  \begin{center}
    \includegraphics[width=2.5in]{UserManualInputs/images/autoimport.eps}
    \caption{Définition des fichiers d'importation}\label{defautoimportex}
  \end{center}
\end{figure}

Il est recommandé d'enregistrer cette configuration en utilisant un nom de fichier unique et représentatif.

Exemple: choisissez le nom de fichier \emph{H04exam} pour \emph{Hiver 2004 horaire d'examen} et le fichier créé sera \emph{H04exam.dim}. L'extension \textbf{\emph{.dim}} est rajouté automatiquement.

    \item Aller au menu \textbf{\emph{Fichier}} et sélectionner le menu \textbf{\emph{Importer automatiquement}}.
    Une boite de dialogue apparaîtra et vous permettra de choisir le fichier \textbf{\emph{.dim}} de «configuration de fichiers»
    précédemment créé à partir de la fonction  \textbf{\emph{Définir fichiers à importer}}
    (dans l'exemple précédent il s'agit du fichier \emph{H04exam.dim}).
    Cliquer à présent sur le bouton \textbf{\emph{Importation de fichiers}},
    toutes vos données (cours, étudiants, enseignants et locaux) seront chargées dans le logiciel et
    prêtes à être modifiées.
\end{enumerate}

À partir de cette étape, la construction de l'horaire à proprement parler peut commencer. Il est vivement recommandé de lancer l'\textbf{\emph{Affectation initiale}} à partir du menu \textbf{\emph{Optimisation}} avant de poursuivre la production de l'horaire. Lancer l'\textbf{\emph{Affectation initiale}} à cette étape exécuterait les fonctionnalités suivantes:

\begin{enumerate}
    \item Suppression des activités de nature 2, seulement les activités de nature 1 seront conservées pour l'horaire. Tous les événements seront initialisés de sorte à les rendre non placés et non figés.
    \item Suppression des groupes aux activités en possédant plusieurs, un seul groupe sera conservé pour l'horaire (le premier groupe ou \emph{groupe A}).
    \item Suppression des événements aux activités en possédant plusieurs, un seul événement sera conservé pour l'horaire.
    \item Modification de la disponibilité des enseignants afin de les rendre tous disponibles.
    \item Modification de la disponibilité des locaux afin de les rendre tous disponibles.
\end{enumerate}

Exemple: Pour construire l'horaire d'examen d'une activité (GEI200) possédant 2 natures (GEI200.1 et GEI200.2), chaque nature possédant 2 groupes (GEI200.1.A, GEI200.1.B et GEI200.2.A, GEI200.2.B), chaque groupe possédant 2 événements (GEI200.1.A.1, GEI200.1.A.2, GEI200.1.B.1, GEI200.1.B.2 et GEI200.2.A.1, GEI200.2.A.2, GEI200.2.B.1, GEI200.2.B.2). La suppression de nature 2, de groupes et d'événements par l'affectation initiale permettrait d'obtenir, pour l'activité GEI200, un seul événement devant servir à l'horaire d'examen, en l'occurrence GEI200.1.A.1.

Cette affectation initiale permettrait donc d'épurer les données et d'initialiser le logiciel de sorte à pouvoir faire des modifications sur les données et observer immédiatement les repercussions sur l'horaire.

La préparation de l'horaire étant achevée, nous pouvons à présent passer à la phase de modification et d'épuration de données (phase 2). Il est cependant nécessaire de noter que cette phase peut avoir lieu avant ou après la phase de construction à proprement parler (phase 3), mais nous recommandons de la faire avant la phase 3 afin de travailler une bonne fois pour toute sur des données propres (épurées).

\subsection{Phase 2: modification et épurations des données}

Le but de cette étape est de permettre de construire l'horaire uniquement à partir de données propres. Cette modification et/ou épuration peut se faire sur les activités, les événements, les groupes d'étudiants, les enseignants ou les locaux.

\begin{itemize}
    \item Modifier une activité en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Activités}} pour voir apparaître la \emph{liste des activités} (voir figure \ref{listacte}) ou alors cliquer sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Événements}} pour voir apparaître la \emph{liste des événements} (voir figure \ref{listeevente}).\\

À partir de la fenêtre \emph{liste des événements}, vous pouvez sélectionner un ou plusieurs événements et les faire passer de la colonne \emph{figés} (les événements sont placées et figées dans la grille horaire) à \emph{placés} (les événements sont placées dans la grille horaire) ou de la colonne \emph{placés} à \emph{non placés} (les événements ne sont pas encore placées dans la grille horaire) et vice-versa.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeact.eps}
        \caption{Liste des activités}\label{listacte}
      \end{center}
    \end{figure}

À partir de la fenêtre \emph{liste des activités}, vous pouvez sélectionner une ou plusieurs activités et les faire passer de la colonne \emph{inclue(s)} à \emph{non inclue(s)} (non inclue(s)= les activités ne seront pas utilisées dans la construction de l'horaire) et vice-versa. \\

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/listeevent.eps}
        \caption{Liste des événements}\label{listeevente}
      \end{center}
    \end{figure}


À partir de l'une ou l'autre des fenêtres, double-cliquer sur l'activité ou l'événement à modifier pour faire apparaître le dialogue d'\emph{affectation d'événements} (voir figure \ref{evente}). Il vous est possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'événement.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/event.eps}
        \caption{Affectation d'événement}\label{evente}
      \end{center}
    \end{figure}
    
Cliquer sur \textbf{\emph{Appliquer}} pour valider les changements et Cliquer sur \textbf{\emph{Fermer}} pour fermer la fenêtre sans appliquer les changements.\\
    
\item Modifier la disponibilité d'un enseignant en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Enseignants}} pour voir apparaître la fenêtre de la figure \ref{enseignante}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaitez modifier. Une zone sélectionnée apparaît en foncé et indique que l'enseignant y est disponible.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/enseignant.eps}
        \caption{Disponibilité des enseignants}\label{enseignante}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour accepter et effectuer les changements et Cliquer sur \textbf{\emph{Ok}} pour accepter, effectuer les changements et fermer la fenêtre.    \\

    \item Modifier la disponibilité d'un local en cliquant sur le menu \textbf{\emph{Affectation}} et le sous menu \textbf{\emph{Locaux}} pour voir apparaître la fenêtre de la figure  \ref{locale}. En sélectionnant une zone correspondant au jour et à l'heure que vous souhaité modifier. Une zone sélectionnée apparaît en foncé et indique que le local y est disponible.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.5in]{UserManualInputs/images/local.eps}
        \caption{Disponibilité des locaux}\label{locale}
      \end{center}
    \end{figure}

Cliquer sur \textbf{\emph{Appliquer}} pour accepter et effectuer les changements et Cliquer sur \textbf{\emph{Ok}} pour accepter, effectuer les changements et fermer la fenêtre.\\

 \end{itemize}

\subsection{Phase 3: construction de l'horaire}

Il est vivement recommandé de commencer cette étape en lançant l'\textbf{\emph{affectation initiale}} à partir du menu \textbf{\emph{Optimisation}} (si cela n'a pas été précédemment fait à la fin de la phase de préparation de l'horaire - section \ref{finprepae}) avant de poursuivre la production de l'horaire. La description des commandes exécutées par l'affectation initiale est faite à la section \ref{finprepae}.

Une fois l'affectation initiale effectuée, l'étape suivante consiste à lancer le sous menu \textbf{\emph{Construire l'horaire}} à partir du menu \textbf{\emph{Optimisation}}, afin de laisser le logiciel placer automatiquement dans la grille horaire les événements (ceux qui n'ont pas encore été placés dans la grille horaire) respectant toutes les contraintes spécifiées et ne créant aucun nouveau conflit (conflits d'enseignants, conflits d'étudiants et conflits de locaux).

La modification des contraintes à respecter par \dx{} lors de la construction automatique de l'horaire se fait en lançant le sous-menu \textbf{\emph{Options Conflits}} à partir du menu \textbf{\emph{Préférences}} pour faire apparaître la fenêtre d'option de conflits (voir figure \ref{conf}). Cette fenêtre permet de modifier plusieurs paramètres, à savoir:

\begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=3.5in]{UserManualInputs/images/optionconflict.eps}
        \caption{Contraintes à respecter}\label{conf}
      \end{center}
    \end{figure}

\begin{itemize}
    \item \emph{Max Conflits Étu entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits d'étudiants entre deux événements, dans une période.
    \item \emph{Max Conflits Ens entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits d'enseignants entre deux événements, dans une période.
    \item \emph{Max Conflits Loc entre 2 Eve}: ce paramètre permet de fixer le nombre maximal admissible de conflits de locaux entre deux événements, dans une période.
    \item \emph{Placer dans périodes (0=normale, 1=normale et basse, 2=normale, basse et nulle)}: ce paramètre permet de spécifier les types de périodes (normale, basse, nulle) de la grille horaire dans lesquels un événement peut être placé.
    \item \emph{Nombre Max de cours dans une période}: ce paramètre permet de spécifier le nombre maximal d'événements pouvant être placés dans une même période de la grille horaire.
    \item \emph{Période d'écart}: ce paramètre permet de spécifier l'écart (en nombre de périodes) à respecter entre deux événements potentiellement en conflit (conflits d'étudiants).
\end{itemize}

Il est possible de modifier les contraintes et lancer ensuite la construction de l'horaire afin que le logiciel  utilise les nouvelles contraintes pour placer les événements qu'il n'a pas pu précédemment placer; tout ceci de façon itérative jusqu'à obtention d'un résultat paraissant satisfaisant aux yeux de l'utilisateur.

Il est également possible de revenir à l'état initial de l'horaire (l'état de l'horaire juste après l'affectation initiale). Pour cela, il suffit de d'ouvrir la fenêtre \textbf{\emph{Liste des événements}} à partir du sous-menu \textbf{\emph{Événements}} du menu \textbf{\emph{Affectation}}, ensuite de sélectionner tous les événements de la colonnes des \textbf{\emph{Placés}}, puis de les faire passer de la colonne des \textbf{\emph{Placés}} à celle des \textbf{\emph{Non placés}} en cliquant sur la flèche allant de la gauche vers la droite et enfin cliquer sur le bouton Appliquer pour effectuer les changements.

Si malgré les itérations, l'horaire construit n'est pas satisfaisant, il existe un certain nombre d'outils permettant de raffiner manuellement l'horaire.

\subsection{Phase 4: raffinement de l'horaire}
Le raffinement de l'horaire propose à travers certains outils (affectation manuelle, modification, rapports), les voies et moyens d'amélioration de l'horaire construit.

\subsubsection{Affectation manuelle}

L'affectation manuelle permet à l'utilisateur de placer individuellement les événements dans la grille horaire. Elle se fait à partir de la fenêtre d'\textbf{\emph{Affection manuelle}} (voir figure \ref{man}) obtenue à partir du sous-menu \textbf{\emph{Affectation manuelle}} du menu \textbf{\emph{Affectation}}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=3.5in]{UserManualInputs/images/manualaffect.eps}
        \caption{Affectation manuelle}\label{man}
      \end{center}
    \end{figure}

La fenêtre d'affectation manuelle offre deux possibilités d'utilisation:

\begin{enumerate}
    \item \textbf{Modification d'un événement:} sélectionner un événement et cliquer sur le bouton \textbf{\emph{Modifier}} pour faire apparaître le dialogue d'\emph{affectation d'événements} (voir figure \ref{evente}). Il vous est possible de modifier, à partir de cette fenêtre d'\emph{affectation d'événements}, le jour et l'heure de début de l'événement, l'enseignant, le local, de placer ou figer l'événement.
    \item \textbf{Recherche de potentiels conflits:} pour rechercher les potentiels conflits générés par un événement, double-cliquer sur l'événement en question pour voir apparaître une nouvelle grille horaire (voir figure \ref{man1}) vous informant sur les conflits que peut généré l'événement dans chaque période de la grille horaire. \\

Une représentation par les couleurs, de la grille horaire d'affectation manuelle, a été adoptée afin de vous permettre, d'un seul coup d'oeil, de repérer les périodes de potentiels conflits (couleur rouge), les périodes dans lesquelles l'événement peut être placé sans générer de conflits (couleur par défaut de la période), et la ou les périodes dans lesquelles l'événement est placé (s'il était précédemment placé dans le grille - couleur verte). Les périodes possédant déjà des conflits avant le lancement de l'amélioration manuelle sont aussi représentées par la couleur rouge; il faut dans ce cas, après le lancement de l'affectation manuelle, regarder pour chaque événement de la période les potentiels conflits avec le nouvel événement.

\subsubsection{Exemple: interprétation d'une période de couleur rouge}

Les données ci-dessous représentent une période la grille horaire d'affectation manuelle de l'événement GEI220.1.01.1.
\begin{verbatim}
ADM111.1.01.1 0 0 0
GEI100.1.01.1 5 0 0
GEI200.1.01.1 5 0 1
     13 0 1
\end{verbatim}

Elles sont interprétées de la manière suivante:
\begin{itemize}
    \item La ligne \verb!ADM111.1.01.1! \textcolor[rgb]{1.00,0.00,0.00}{0 0 0} représente les potentiels conflits entre les événements \verb!ADM111.1.01.1! et \verb!GEI220.1.01.1!. Elle indique 0 conflit d'étudiants, 0 conflit d'enseignants et 0 conflit de locaux.
    \item La ligne \verb!GEI100.1.01.1! \textcolor[rgb]{1.00,0.00,0.00}{5 0 0} représente les potentiels conflits entre les événements \verb!GEI100.1.01.1! et \verb!GEI220.1.01.1!. Elle indique 5 conflits d'étudiants, 0 conflit d'enseignants et 0 conflit de locaux.
    \item La ligne \verb!GEI200.1.01.1! \textcolor[rgb]{1.00,0.00,0.00}{5 0 1} représente les potentiels conflits entre les événements \verb!GEI200.1.01.1! et \verb!GEI220.1.01.1!. Elle indique 5 conflits d'étudiants, 0 conflit d'enseignants et 1 conflit de locaux.
    \item La ligne \textcolor[rgb]{1.00,0.00,0.00}{13 0 1} représente la somme des potentiels conflits de la période (10 conflicts d'étudiants, 0 conflit d'enseignants, 1 conflit de locaux) aux conflits réels existant dans la période (3 conflits d'étudiants, 0 conflit d'enseignants et 0 conflit de locaux).
\end{itemize}    

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/manualaffectres.eps}
        \caption{Grille horaire d'affectation manuelle}\label{man1}
      \end{center}
    \end{figure}

\end{enumerate}


\subsubsection{Modification des activités}

La fonctionnalité de modification des activités permet d'ajouter ou supprimer une nature à une activité, d'ajouter ou supprimer un groupe à une nature d'activité, d'ajouter ou supprimer un bloc à un groupe et enfin modifier la durée d'un événement ou affecter un événement comme présenté dans la figure \ref{evente}. Il faut cependant noter qu'elle ne permet pas d'ajouter une activité.

On pourrait par contre se poser la question de savoir pourquoi pour des horaires d'examen, les termes tels que activité, nature, groupe et blocs resurgissent à la place du terme examen par exemple. La réponse réside dans l'approche utilisée; car, que ce soit pour les cours, que pour les examens, la construction d'un horaire se fait à travers des événements. Pour les horaires de cours, un événement représente un cours - quadruplet (activité,nature,groupe,bloc) - qui doit avoir lieu, tandis que pour les horaires d'examen, un événement représente un examen qui doit avoir lieu. Dans un soucis d'homogénéité, nous avons donc déduit qu'un examen d'une activité pourrait être vue comme événement résultant d'une activité ne possédant qu'une seule nature (la nature 1), cette nature ne possédant qu'un seul groupe et ce groupe ne possédant qu'un seul bloc.

Cette approche offre donc la possibilité de pouvoir attribuer à une activité, un examen de nature 2 (laboratoire) ou encore de diviser un examen devant se tenir dans un local en deux groupes afin qu'ils se déroulent dans deux locaux distincts.

La modification d'une activité se fait en cascade, c'est à dire que pour faire des modifications sur un niveau, il faudrait traverser les niveaux précédents (par exemple, pour faire des modifications sur un groupe, il faut d'abord sélectionner l'activité concernée, ensuite sélectionner la nature et enfin sélectionner le groupe concerné).

\subsubsection{Ajout/suppression d'une nature à une activité}

Ajouter et/ou supprimer une nature à une activité se fait en lançant le sous menu \textbf{\emph{Activité}} à partir du menu \textbf{\emph{Modification}}, pour faire apparaître la fenêtre d'activités de la figure \ref{modifacte}.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifact.eps}
        \caption{Modification d'activités}\label{modifacte}
      \end{center}
    \end{figure}

Double cliquer sur une activité pour faire apparaître la fenêtre de natures de la figure \ref{modiftypee}. Toutes les natures de l'activité sélectionnée apparaissent dans cette fenêtre.

    \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modiftype.eps}
        \caption{Modification de natures}\label{modiftypee}
      \end{center}
    \end{figure}

\begin{itemize}
    \item On ne peut ajouter qu'une nature 2 à une activité possédant préalablement une nature 1. Pour le faire cliquer simplement sur le bouton \textbf{\emph{Ajouter}}.
    \item On ne peut supprimer qu'une nature 2 à une activité. Pour le faire cliquer simplement sur le bouton \textbf{\emph{Supprimer}}.
\end{itemize}

\subsubsection{Ajout/suppression d'un groupe à une nature d'activité}

À partir de la fenêtre de modification de natures (voir figure \ref{modiftypee}), double cliquer sur une nature d'activité pour faire apparaître la fenêtre de groupes de la figure \ref{modifgroupee}. Tous les groupes de la nature sélectionnée apparaissent dans cette fenêtre.

 \begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifgroupe.eps}
        \caption{Modification de groupes}\label{modifgroupee}
      \end{center}
    \end{figure}

\begin{itemize}
    \item Pour ajouter un groupe cliquer sur le bouton \textbf{\emph{Ajouter}} pour voir apparaître la fenêtre de la figure \ref{modifgroupeselece}
\begin{figure}[h]
      % Requires \usepackage{graphicx}
      \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/modifgroupeselect.eps}
        \caption{Choix du groupe à ajouter}\label{modifgroupeselece}
      \end{center}
    \end{figure}
    Entrer le nom du groupe à ajouter et cliquer sur \textbf{\emph{Ok}} (Exemple: pour créer un groupe 3, entrer dans la zone \emph{Numéro de groupe} la valeur 03).
    \item Pour supprimer un groupe, sélectionner le groupe à supprimer et cliquer simplement sur le bouton \textbf{\emph{Supprimer}}.
\end{itemize}

\subsubsection{Ajout/suppression d'un bloc à un groupe d'une nature d'activité}

À partir de la fenêtre de modification de groupe (voir figure \ref{modifgroupee}), double cliquer sur un groupe pour faire apparaître la fenêtre de blocs de la figure \ref{modifbloce}. Tous les blocs du groupe sélectionné apparaissent dans cette fenêtre.

    \begin{figure}[h]
        % Requires \usepackage{graphicx}
        \begin{center}
            \includegraphics[width=2.0in]{UserManualInputs/images/modifunit.eps}
            \caption{Choix du groupe à ajouter}\label{modifbloce}
        \end{center}
    \end{figure}

\begin{itemize}
    \item On ne peut ajouter un bloc à un groupe en cliquant simplement sur le bouton \textbf{\emph{Ajouter}}. Le nouveau bloc est créé à la suite du dernier bloc de la liste.
    \item Pour supprimer un bloc, cliquer simplement sur le bouton \textbf{\emph{Supprimer}} et le dernier bloc de la liste sera supprimé. Si la liste ne possède qu'un seul bloc, ce dernier ne pourra pas être supprimé.
\end{itemize}

\subsubsection{Rapports}

La fonctionnalité rapport permet de visualiser le rapport complet des événements placés dans la grille horaire, de visualiser le rapport de conflits générés par les événements placés dans la grille horaire et de visualiser les erreurs survenues lors de l'importation de données.

\subsubsection{Rapport complet}

Le rapport complet permet de visualiser les événements placés dans la grille horaire (voir figure \ref{rapfulle}).

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/rap_full.eps}
        \caption{Rapport complet}\label{rapfulle}
    \end{center}
\end{figure}

Les informations affichées sont trier en partant de la colonne de gauche vers la droite. Les abbreviations utilisées au niveau de l'entête du rapport se définissent comme suit:

\begin{itemize}
    \item \emph{JNum}: numéro de de la journée (jour 1, jour 2, ...),
    \item \emph{Jour}: nom de la journée (lundi, mardi, ...),
    \item \emph{Acti}: nom de l'activité,
    \item \emph{Nat}: nature de l'activité,
    \item \emph{Grp}: groupe de l'activité,
    \item \emph{Blc}: bloc de l'activité,
    \item \emph{Nomb É}: nombre d'étudiants,
    \item \emph{Durée}: durée de l'événement,
    \item \emph{Début}: heure de début de l'événement,
    \item \emph{Fin}: heure de fin de l'événement,
    \item \emph{Enseignant}: nom de l'enseignant,
    \item \emph{Local}: nom du local.
\end{itemize}

Les informations à afficher pour chaque événement peuvent être définies à partir de la fenêtre d'\textbf{\emph{Option de rapport}}, en cliquant sur le bouton \textbf{\emph{Options}} à partir de la fenêtre de \textbf{\emph{Rapport complet}} (voir figure \ref{rapfulle}).

\subsubsection{Option de rapport complet}

Cette fenêtre d'\textbf{\emph{Option de rapport}} (voir figure \ref{rapfulloptionse}) permet de choisir les information à afficher dans le rapport complet. L'ordre d'apparition des champs dans la colonne \emph{Champs choisis} (du haut vers le bas), définit l'ordre dans lequel ces champs apparaîtront dans le rapport complet (de la gauche vers la droite).

Utiliser les boutons avec les flèches pour déplacer un champ d'une colonne vers une autre et les boutons avec les signes $+$ ou $-$ pour déplacer un champ du haut vers le bas et vice-versa.

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/rap_full_options.eps}
        \caption{Options du rapport complet}\label{rapfulloptionse}
    \end{center}
\end{figure}


\subsubsection{Rapport de conflits}

Le rapport de conflits permet de visualiser les conflits générés par les événements placés dans la grille horaire (voir figure \ref{rapconfe}).

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=4.0in]{UserManualInputs/images/rap_conflicts.eps}
        \caption{Rapport de conflits}\label{rapconfe}
    \end{center}
\end{figure}

Les informations affichées sont trier en partant de la colonne de gauche vers la droite. Les abbreviations utilisées au niveau de l'entête du rapport se définissent comme suit:

\begin{itemize}
    \item \emph{JNum}: numéro de de la journée (jour 1, jour 2, ...),
    \item \emph{Jour}: nom de la journée (lundi, mardi, ...),
    \item \emph{PérJour}: période de la journée (AM, PM),
    \item \emph{Événement 1 }: premier événement en conflit,
    \item \emph{Événement 2}: événement avec lequel l'événement 1 est en conflit ou description du conflit si l'événement 1 présente un conflit interne (disponibilité de l'enseignant, disponibilité du local et/ou capacité du local inférieur au nombre d'étudiants).
    \item \emph{Début}: heure de début de l'événement,
    \item \emph{Type Conf}: type de conflits (étudiant, enseignant ou local),
    \item \emph{Numb C}: nombre de conflits,
    \item \emph{Conflits}: détail du conflit (liste des étudiants en conflit, nom du local ou de l'enseignant en conflit).
\end{itemize}

Les informations à afficher pour chaque conflit peuvent être définies à partir de la fenêtre d'\textbf{\emph{Option de conflits}}, en cliquant sur le bouton \textbf{\emph{Options}} à partir de la fenêtre de \textbf{\emph{Rapport de conflits}} (voir figure \ref{rapconfe}).

\subsubsection{Option de rapport de conflits}

Cette fenêtre d'\textbf{\emph{Option de conflits}} (voir figure \ref{rapconfoptionse}) permet de choisir les information à afficher dans le rapport de conflits. L'ordre d'apparition des champs dans la colonne \emph{Champs choisis} (du haut vers le bas), définit l'ordre dans lequel ces champs apparaîtront dans le rapport complet (de la gauche vers la droite).

Utiliser les boutons avec les flèches pour déplacer un champ d'une colonne vers une autre et les boutons avec les signes $+$ ou $-$ pour déplacer un champ du haut vers le bas et vice-versa.

\begin{figure}[h]
% Requires \usepackage{graphicx}
    \begin{center}
        \includegraphics[width=2.0in]{UserManualInputs/images/rap_conflicts_options.eps}
        \caption{Options du rapport de conflits}\label{rapconfoptionse}
    \end{center}
\end{figure}

\subsection{Phase 5: Exportation}

Pour exporter les données, aller au menu \textbf{\emph{Fichier}}, puis sélectionner \textbf{\emph{Exporter}}; deux fichiers seront créés dans le repertoire racine de votre document avec les noms suivants:
\begin{itemize}
    \item \verb!«nom du document»_Export_1.txt! (il contient l'horaire);
    \item \verb!«nom du document»_Export_2.txt! (il contient les étudiants, leurs examens).
\end{itemize}     