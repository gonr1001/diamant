\chapter{Description des fichiers d'entrée de  \diamant{}}

Les  versions 1.0 et 1.5 de \diamant{} utilisent les fichiers
suivantes~:

\begin{enumerate}
    \item Étudiants.
    \item Instructeurs.
    \item Activités.
    \item Locaux
\end{enumerate}

Les trois premiers sont produits au STI (Système informatique
central) et transférés via FTP.
Le fichier de locaux est produit
localement par l'utilisateur.

Tous les fichiers ont un format très
rigide. Le nombre de caractères et leur position est à respecter
obligatoirement.

Les indexes de chaînes de caractères commencent à \verb!0!.



\section{Fichier d'étudiants}

Ce fichier est un héritage de format \saphir{}.

\subsection{Exemple des données qu'il contient}

\begin{verbatim}
001342
009008132035030720003LUPIEN MY05
CTB301101 GIS251102 GIS351102 GRH111101 GRH332101
009011991290000520021AUDET FRE05
CTB341101 FEC111102 FEC444101 GIS114101 MAR221107
009022232035010720003AUDET STE05
CTB443102 CTB451101 CTB513101 CTB563101 CTB613102
009027042035010720003VEILLEUX 05
CTB443101 CTB451102 CTB513102 CTB563101 CTB613102
009031242035010720003FAUCHER M05
\end{verbatim}

\subsection{Signification des données}

Il existe trois types de lignes :

\begin{enumerate}
    \item nombre d'étudiants dans le fichier;
    \item identification de l'étudiant et nombre de cours qu'il prend;
    \item l'identification de cours que l'étudiant suit.
\end{enumerate}

La structure du fichier :

\begin{enumerate}
\item La chaîne du début du fichier $n$, \verb!001342!, nous indique
le nombre d'étudiants contenus dans ce fichier. Il s'agit d'une ligne du premier type.
\item Ensuite il y a $n$ couples de lignes du type 2 et 3.
    \begin{enumerate}
    \item La ligne de type 2 contient des chiffres et des lettres correspondant au numéro
d'identification unique de l'étudiant, son nom et le nombre de cours qu'il suit.

    \item La ligne de type 3 contient le cours et éventuellement le groupes
    \end{enumerate}
\end{enumerate}

Les détails de la ligne de type 2.

\begin{itemize}
      \item Le matricule de l'étudiant qui correspond aux huit premiers caractères
      du numéro d'identification (Indices 0 à 7).
       Dans notre exemple, \verb!00900813! pour l'étudiant
       \verb!LUPIEN! et \verb!00901199! pour l'étudiante \verb!AUDET!.
      \item Le programme auquel l'étudiant appartient correspond ensuite aux
      six caractères suivants.
      Soit \verb!203503! dans le cas du premier étudiant (Indices 8 à 13).
     \item L'instance du programme que l'étudiant suit correspond aux deux
      caractères suivants.
     Soit \verb!07! dans le cas du premier étudiant (Indices 14 à 15).
      \item Des informations sur l'admission de l'étudiant sont données
      par les cinq caractères suivants.
       Les quatre premiers correspondent à l'année d'admission tandis
       que le cinquième indique le trimestre d'admission.
        Soit \verb!20003! dans le cas du premier étudiant (Indices 16 à 20).
    \item Suivent ensuite neuf caractères pour indiquer le nom de famille
    de l'étudiant suivi d'un espace et de son prénom (coupé après neuf espaces) (Indices 21 à 29).
    Soit, dans notre exemple, \verb!LUPIEN MY! dans le cas de la première étudiante.
    Dans certains cas le nom prend les neuf caractères.
    \item Vient alors un chiffre de deux caractères qui correspond en fait au nombre de cours que suit l'étudiant.
    \verb!05! dans le cas du premier étudiant (Indices 30 à 31).
\end{itemize}

Les détails de la ligne de type 3.

Elle contient la liste des activités suivies par
l'étudiant séparées par un espace. Voici un exemple d'information correspondant à chaque
cours.

\begin{itemize}
\item Soit \verb!CTB301101! dans le cas du premier étudiant.
Les 6 premiers caractères (\verb!GEI441!) correspondent au numéro
du cours. Le septième caractère (\verb!1!) correspond à la nature ou type d'activité
du cours (1=Leçon Magistrale et 2=autre). Le 2 derniers caractères
(\verb!01!) sont facultatifs dans un fichier et ils correspondent
au groupe d'activité dans lequel l'étudiant est assigné.
\end{itemize}

Un fichier peut avoir le groupe d'activité pour certains étudiants, Faculté d'administration.

\subsection{Définition  et utilisation des champs}

\pro{long int eMatricule} correspond aux indices 0 à 7 de la ligne de type deux.
Il est mis dans \verb!_resourceKey!.

\pro{String eNom} correspond aux indices 21 à 29 de la ligne de type deux.
Il est mis dans \verb!_resourceID!.

\pro{String eAuxField} correspond aux indices 8 à 20 de la ligne de type deux.
Il est mis dans \verb!_auxField!.

\pro{String eSelectedCourse} il peut avoir 1 à $n$ \pro{eSelectedCourse}, qui sont considérés comme
une liste de cours, ceci correspond aux cours dans la ligne de type trois.
Il est mis dans \verb!_resourceAttach!.

\section{Fichier d'instructeurs}\label{instructor}

Ce fichier contient les données de disponibilités des enseignants.
Ce fichier est aussi un héritage de format \saphir{}.

\subsection{Exemple des données qu'il contient}


\begin{verbatim}
116
ATALLA, NOUREDDINE
1 1 1 1 5 5 5 5 5 5 5 5 5 5
5 5 5 5 5 5 5 5 5 5 5 5 5 5
5 5 5 5 5 5 5 5 5 5 5 5 5 5
5 5 5 5 5 5 5 5 5 5 5 5 5 5
1 1 1 1 5 5 5 5 5 5 5 5 5 5
BALLIVY, GÉRARD
1 1 1 1 5 1 1 1 1 1 5 5 5 5
1 1 1 1 5 1 1 1 1 1 5 5 5 5
1 1 1 1 5 1 1 1 1 1 5 5 5 5
1 1 1 5 5 1 1 1 1 5 5 5 5 5
1 1 1 1 5 1 1 1 5 5 5 5 5 5
\end{verbatim}


\subsection{Signification des données}

Il existe trois types de lignes :

\begin{enumerate}
    \item le nombre d'enseignants dans le fichier;
    \item l'identification de l'enseignant;
    \item disponibilité d'une journée.
\end{enumerate}

La structure du fichier :

\begin{enumerate}
\item La chaîne du début du fichier $n$, \verb!116!, nous indique
le nombre d'enseignants contenus dans ce fichier. Il s'agit d'une ligne du premier type.
\item Ensuite il y a $n$ couples de lignes une de type 2 et cinq de type 3.
    \begin{enumerate}
    \item La ligne de type 2 est une chaîne de caractères correspondant nom et prénom
    de l'enseignant. La chaîne ne doit pas excéder trente caractères.
    \item La ligne de type 3 décrit la disponibilité de l'enseignant sur une journée et comporte quatorze entiers séparés par
    un espace.
    \end{enumerate}
\end{enumerate}

Les détails de la ligne de type 3.

Elle contient la liste des disponibilités d'un enseignant sur une journée et comporte quatorze entiers (0 ou 1) séparés par un espace.

Chacune des cinq lignes de type 3 représente une journée, en commençant par lundi, jusqu'à vendredi. Chaque colonne correspondant à un entier (0 ou 1) représente une heure dans la journée (8h30, 9h30, 10h30, 11h30, 12h30, 13h30, 14h30, 15h30, 16h30, 17h30,  18h30, 19h00, 20h00 et 21h00). Les disponibilités sont ainsi connues entre 8h30 et 21h00.

\subsection{Définition  et utilisation des champs}

\pro{String eNom} correspond aux nom et prénom de la ligne de type deux.
Il est mis dans \verb!_resourceID!.

\pro{String eVailability} correspond à la liste des disponibilités des lignes de type trois.
elle est mise dans \verb!_resourceAttach!.

\section{Fichier d'activités}

Ce fichier contient des informations concernant les cours offerts à une session. Nous y retrouvons la liste des
activités associées, l'agencement du cours, le nom de l'enseignant qui le donnera, etc.
C'est un fichier préalable à la construction de l'horaire.

\subsection{Exemple des données qu'il contient}


\begin{verbatim}

ADM1111  A
1
1
LUC LAJOIE


 2
 2 1
 2 1 4 2
1 1
C1-387 C1-380
0 0
0 0
0 0

ADM1111  B
1
1
RÉAL CAOUETTE


 1
 3
 2 12
1
C1-387
0
0
0

AMC6401  A
1
1
FADI AL-HAMED


 2
 2 1
 2 1 4 2
1
D73020
0
0
0
\end{verbatim}


\subsection{Signification des données}

Il existe treize types de lignes :

\begin{enumerate}
    \item la ligne vide;
    \item l'identification du cours;
    \item l'état du cours (actif ou inactif);
    \item le nombre d'activités associées au cours;
    \item le nom de l'enseignant du cours;
    \item le nombre d'unités de périodes séparées (exp: une unité de 2h et une autre de 1h);
    \item la durée de chacune des unités prévues à la ligne précédente;
    \item le jour et l'heure de début de chacune des unités décrites à la ligne précédente;
    \item l'état du local affecté à chaque unité (fixé ou non fixé);
    \item le nom du local assigné à chaque unité;
    \item le type de locaux requis à chaque unité;
    \item le type de locaux requis à chaque unité;
    \item état d'affectation de chaque unité dans la grille horaire.
\end{enumerate}

La structure du fichier :


\begin{enumerate}
\item Le fichier commence par une ligne vide, il s'agit d'une ligne du premier type.
\item Ensuite il y a $n$ couples de lignes allant du type 2 au type 13.
    \begin{enumerate}
    \item La ligne de type 2 est une chaîne de caractères correspondant au sigle
    du cours (\verb!ADM1111 A!).
    Ceci décrit la leçon magistrale \verb!1!  du cours \verb!ADM111! avec le groupe \verb!A!).
    Dans l'exemple cette ligne contient \verb!ADM1111 A!
    \item La ligne de type 3 décrit l'état du cours,
    c'est une valeur entière (0 si le cours est inactif et 1 dans l'autre cas).
    Dans l'exemple cette ligne contient \verb!1!
    \item La ligne de type 4 décrit le nombre d'activités associées au cours, c'est une valeur entière.
    Dans l'exemple cette ligne contient \verb!1!
    \item La ligne de type 5 est une chaîne de caractères correspondant au nom de l'enseignant.
    Dans l'exemple cette ligne contient \verb!LUC LAJOIE!
    \item La ligne de type 6  le nombre de blocs de périodes séparées de la première fiche
    (ex: si nous avons deux heures de cours collées à
    trois endroits différents dans l'horaire, l'entier sera 3).
    Dans l'exemple cette ligne contient \verb!2!
    \item La ligne de type 7. Nous avons une suite de nombres qui correspond
    à la durée de chacun des blocs prévus à la ligne précédente.
    Dans ce cas-ci, la durée du premier bloc est de deux périodes
    alors que la durée du deuxième est de seulement une période.
    Dans l'exemple cette ligne contient \verb!2 1!
    \item La ligne de type 8,  On a une  liste d'entiers représentant
    le jour et l'heure de chacun des blocs précédents.
    Par exemple, \texttt{2 1} nous indique que le premier bloc a lieu le mardi à 8h30
    alors que \texttt{4 2} nous apprends que le deuxième bloc est le jeudi à 9h30.
    Dans le exemple cette ligne contient \verb!2 1 4 2!
    \item La ligne de type 9.  Cette ligne nous indique si le local de cette activité est fixé ou non.
    Effectivement, un \texttt{1} nous dit qu'il l'est alors qu'un \texttt{0} nous indique le contraire.
    Dans l'exemple cette ligne contient \verb!1 1!
    \item La ligne de type 10. Sur cette ligne, nous avons les nom des locaux pour le premier
    et le deuxième bloc respectivement.
    Dans l'exemple cette ligne contient \verb!C1-387 C1-380!
    \item La ligne de type 11. Puis vient le type de locaux requis par cette activité
    (voir le manuel d'utilisation de \saphir{} \cite{ruben94}).
    Dans l'exemple cette ligne contient \verb!0 0!
    \item La ligne de type 12. Idem (voir le manuel d'utilisation de \saphir{} \cite{ruben94}).
    Dans l'exemple cette ligne contient \verb!0 0!
    \item La ligne de type 13. Finalement, cette rangée permet de savoir si le bloc à été
    pré-affecté à l'horaire \texttt{(1)} ou non \texttt{(0)}.
    Dans le'exemple cette ligne contient \verb!0 0!
    \end{enumerate}
\end{enumerate}

Ensuite le fichier continue.

\section{Fichier de locaux}\label{room}

\subsection{Exemple des données qu'il contient}

\begin{verbatim}
//Faculté des sciences;

//Nom du local;Capacité;Fonction;Liste des caractéristiques;Notes;

D13012;32;211;08,11,14,57;laboratoire de chimie;
D13013;40;211;08,11,57;laboratoire de chimie;
D13014;20;211;08,44,57;laboratoire de chimie;
D13016;18;211;08,57;laboratoire de chimie;
\end{verbatim}

\subsection{Signification des données}

\begin{description}
    \item[Première ligne] cette ligne représente la faculté.
    \item[Deuxième ligne] cette ligne décrit le fichier.
    \item[Troisième ligne] cette ligne est blanche.
    \item[Quatrième ligne] cette ligne décrit l'organisation des informations sur les locaux.
    \item[Cinquième ligne] cette ligne est blanche
    \item[De la sixième à la dernière ligne ] chaque ligne donne les informations sur un local. Chaque information est séparée par un \texttt{;} et est décrite comme suit:
    \begin{itemize}
        \item Le nom du local \texttt{D13012} pour le premier local.
        \item La capacité du local \texttt{32} pour le premier local.
        \item La fonction du local \texttt{211} pour le premier local (voir le manuel d'utilisation de \saphir{} \cite{anoyme94})
        \item Liste des caractéristiques 08,11,14,57 pour le premier local (voir le manuel d'utilisation de \saphir{} \cite{anoyme94}). Il peut y avoir plusieurs caractéristique, elles seront séparées par des \texttt{,}
        \item La description du local \texttt{laboratoire de chimie} pour le premier local.
    \end{itemize}
\end{description}
